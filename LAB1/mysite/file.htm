<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><!-- InstanceBegin template="/Templates/net.dwt" codeOutsideHTMLIsLocked="false" -->
<head>
<!-- InstanceBeginEditable name="doctitle" --> 
<title>Файлы и каталоги | Технология .Net | mista.ru</title>
<!-- InstanceEndEditable -->
<meta http-equiv="Content-Type" content="text/html; charset=windows-1251">
 <!-- InstanceBeginEditable name="head" --><!-- InstanceEndEditable -->
<link href="../style.css" rel="stylesheet" type="text/css">
</head>

<body bgcolor="#FFFFFF" text="#000000" link="#0000CC" vlink="#990066" alink="#CC0066" leftmargin="0" topmargin="0" marginwidth="0" marginheight="0">
<table width="100%" border="0" cellspacing="0" cellpadding="0">
  <tr> 
    <td width="180" background="fon2.gif" bgcolor="#FFFFCC" class="unnamed1"> 
      <a name="begin"></a><a href="http://www.mista.ru"><img src="logo.gif" alt="Информационные системы" width="180" height="70" border="0"></a></td>
    <td background="fon2.gif" bgcolor="#FFFFCC" class="unnamed5"> 
      <div align="center"><!-- InstanceBeginEditable name="title" --><font color="#CC0000" size="6" face="Verdana, Arial, Helvetica, sans-serif">Файлы 
        и каталоги</font><!-- InstanceEndEditable --></div></td>
  </tr>
</table>
<table width="100%" height="90%" border="0" cellpadding="0" cellspacing="0">
  <tr> 
    <td width="180" valign="top" background="fon.gif" bgcolor="#FFFFCC" class="unnamed1"> 
      <table width="175" border="0" align="right" cellpadding="0" cellspacing="0">
        <tr> 
          <td width="100%" valign="top"> 
            <p><font color="#CC0000" size="3" face="Arial, Helvetica, sans-serif"><a href="../it.htm"><font color="#330099" size="2" face="Verdana, Arial, Helvetica, sans-serif"><strong><font color="#CC0000" size="3" face="Arial, Helvetica, sans-serif"><br>
              Информационные технологии</font></strong></font></a> </font></p>
            <p><font color="#330099" size="2" face="Verdana, Arial, Helvetica, sans-serif"><strong><font size="2"><font color="#330099" size="2" face="Verdana, Arial, Helvetica, sans-serif"><strong><img src="../ball.gif" width="17" height="17" align="absmiddle"> 
              <a href="index.htm">Технология .Net </a></strong></font></font></strong></font></p>
            <p><font face="Arial, Helvetica, sans-serif" size="2"><a href="intro.htm">Что 
              такое .Net</a><br>
              </font><font face="Arial, Helvetica, sans-serif" size="2"><a href="net_framework.htm">.Net 
              Framework</a><br>
              <a href="vbnet_future.htm">VB.Net: дорога в будущее</a><br>
              <a href="vbnet_types.htm">Типы данных VB.Net</a><br>
              </font><font face="Arial, Helvetica, sans-serif" size="2"><a href="vbnet_impression.htm">Впечатление 
              от VB.Net</a><br>
              <a href="links.htm">Ссылки по Net</a> </font></p>
            <table width="99%" border="1" cellspacing="0" cellpadding="5" bordercolor="#FFCC33">
              <tr> 
                <td> <p><font face="Arial, Helvetica, sans-serif" size="2">1. 
                    <a href="clr.htm">CLR - Введение</a><br>
                    2. <a href="clr2.htm">CLR - Часть 2</a><br>
                    3. <a href="vs.htm">Visual Studio.Net</a><br>
                    4. <a href="lib.htm">Библиотека классов </a><br>
                    5. <a href="array.htm">Массивы и коллекции</a><br>
                    6. <a href="string.htm">Строки</a><br>
                    7. <a href="file.htm">Файлы и каталоги</a><br>
                    8. <a href="stream.htm">Потоки ввода-вывода</a></font></p>
                  <p align="right"><font face="Arial, Helvetica, sans-serif" size="2"><i><a href="http://www.compress.ru" target="_blank">Компьютер</a></i><a href="http://www.compress.ru" target="_blank"><i>Пресс</i></a> 
                    </font></p></td>
              </tr>
            </table>
            <br>
            <hr width="95%" size="1" noshade>
            <p><font color="#330099" size="2" face="Verdana, Arial, Helvetica, sans-serif"><strong><font size="2"><font color="#330099" size="2" face="Verdana, Arial, Helvetica, sans-serif"><strong><img src="../ball.gif" width="17" height="17" align="absmiddle"> 
              <a href="../isu/index.htm">Инф. системы</a></strong></font></font><font size="2"><font color="#330099" size="2" face="Verdana, Arial, Helvetica, sans-serif"><strong><br>
              <font size="2"><font color="#330099" size="2" face="Verdana, Arial, Helvetica, sans-serif"><strong><img src="../ball.gif" width="17" height="17" align="absmiddle"> 
              <a href="../gorod/index.htm">Модель города</a></strong></font></font><br>
              <img src="../ball.gif" width="17" height="17" align="absmiddle"></strong></font> 
              <font color="#330099" face="Verdana, Arial, Helvetica, sans-serif"><a href="../itbooks.htm">Книги 
              и статьи</a></font></font></strong></font><font color="#330099" size="2" face="Verdana, Arial, Helvetica, sans-serif"><strong><br>
              <font size="2"><font color="#330099" size="2" face="Verdana, Arial, Helvetica, sans-serif"><strong><img src="../ball.gif" width="17" height="17" align="absmiddle"></strong></font> 
              <a href="../era/index.htm">ЭРА</a> </font></strong></font></p>
            <p><a href="../1c.htm"><font color="#330099" size="2" face="Verdana, Arial, Helvetica, sans-serif"><strong><font color="#CC0000" size="3" face="Arial, Helvetica, sans-serif">1С:Предприятие</font></strong></font></a> 
            </p>
            <p><font color="#CC0000" size="3" face="Arial, Helvetica, sans-serif"><a href="../interesting.htm"><font color="#330099" size="2" face="Verdana, Arial, Helvetica, sans-serif"><strong><font color="#CC0000" size="3" face="Arial, Helvetica, sans-serif">Интересное</font></strong></font></a></font> 
            </p>
            <!-- InstanceBeginEditable name="EditRegion2" --> <!-- InstanceEndEditable --> 
            </td>
        </tr>
      </table>
    </td>
    <td valign="top" class="unnamed1">  
      <table width="100%" border="0" cellpadding="3" cellspacing="0">
        <tr> 
          <td valign="top" bgcolor="#FFFFCC" class="unnamed4"> <!-- InstanceBeginEditable name="navigation" --><a href="../index.htm">mista.ru</a> 
            / <a href="../it.htm">Инф. технологии</a> / <a href="index.htm">Технология 
            .Net</a> / Файлы и каталоги<!-- InstanceEndEditable --></td>
        </tr>
      </table>
      <table width="100%" border="0" cellspacing="0" cellpadding="5">
        <tr>
          <td height="65"><!-- InstanceBeginEditable name="text" -->
            <p align="right"><font face="Arial, Helvetica, sans-serif" size="2">Алексей 
              Федоров<a href="http://www.compress.ru" target="_blank"><br>
              КомпьютерПресс</a> 7'2002</font></p>
            <p align="justify"><font face="Arial, Helvetica, sans-serif" size="2">&nbsp;&nbsp;&nbsp;<a class=contents 
href="http://www.compress.ru/Temp/3485/index.htm#01">Класс FileSystemInfo</a><br>
              </font><font face="Arial, Helvetica, sans-serif" size="2">&nbsp;&nbsp;&nbsp;<a class=contents 
href="http://www.compress.ru/Temp/3485/index.htm#02">Класс FileInfo</a><br>
              </font><font face="Arial, Helvetica, sans-serif" size="2">&nbsp;&nbsp;&nbsp;<a class=contents 
href="http://www.compress.ru/Temp/3485/index.htm#03">Класс DirectoryInfo</a><br>
              </font><font face="Arial, Helvetica, sans-serif" size="2"><a class=contents 
href="http://www.compress.ru/Temp/3485/index.htm#04">Перечисление Environment.SpecialFolder</a><br>
              </font><font face="Arial, Helvetica, sans-serif" size="2">&nbsp;&nbsp;&nbsp;<a class=contents 
href="http://www.compress.ru/Temp/3485/index.htm#05">Класс File</a><br>
              </font><font face="Arial, Helvetica, sans-serif" size="2">&nbsp;&nbsp;&nbsp;<a class=contents 
href="http://www.compress.ru/Temp/3485/index.htm#06">Класс Path</a></font></p>
            <p align="justify"><font face="Arial, Helvetica, sans-serif" size="2">Мы 
              завершаем знакомство с Microsoft .NET Framework (см. КомпьютерПресс 
              № 11-12’2001, 1-5’2002) и библиотекой классов .NET Framework Class 
              Library. В этом номере мы рассмотрим классы из пространства имен 
              System.IO — FileSystemInfo, FileInfo, DirectoryInfo, File и Path, 
              используемые для работы с файлами и каталогами.</font></p>
            <p align="justify"><font face="Arial, Helvetica, sans-serif" size="2">Пространство 
              имен System.IO содержит ряд классов, используемых для работы с файловой 
              системой. Класс FileSystemInfo служит в качестве базового класса 
              для классов FileInfo и DirectoryInfo. Для работы с файлами используется 
              класс File, а для работы с каталогами — класс Directory. Упомянутые 
              классы показаны на следующей <a 
href="http://www.compress.ru/Temp/3485/1.htm">диаграмме</a>.</font></p>
            <p align="center"><img src="file_1.gif" width="300" height="196"></p>
            <p align="justify"><font face="Arial, Helvetica, sans-serif" size="2">Обратите 
              внимание на различия между показанными выше классами. Класс FileInfo 
              предоставляет методы для создания, копирования, удаления, перемещения 
              и открытия файлов и помогает в создании объектов типа FileStream. 
              Класс File предоставляет статические методы — для их использования 
              не требуется создавать экземпляр класса. Это справедливо и для классов 
              DirectoryInfo и Directory. Классы FileInfo и DirectoryInfo являются 
              «запечатанными» классами (sealed classes) — мы можем создавать экземпляры 
              этих классов, но наследовать от них невозможно.</font></p>
            <hr noshade size="1" width="85%">
            <h3><font face="Arial, Helvetica, sans-serif" size="3"><img src="rombik.gif" width="31" height="27" align="absmiddle"><a name=01></a>Класс 
              FileSystemInfo</font></h3>
            <p align="justify"><font face="Arial, Helvetica, sans-serif" size="2">Этот 
              класс определяет базовую функциональность для унаследованных классов 
              — классов FileInfo и DirectoryInfo. Он содержит свойства и методы, 
              общие для управления и файлами, и каталогами. Ниже приведен список 
              свойств и методов класса FileSystemInfo.</font></p>
            <ul>
              <li><font face="Arial, Helvetica, sans-serif" size="2">Attributes 
                — используется для получения или установки атрибутов файла. Это 
                свойство имеет тип FileAttributes, который поддерживает битовые 
                операции над значениями членов. Ниже показаны члены перечисления 
                FileAttributes: </font> 
                <ul>
                  <li><font face="Arial, Helvetica, sans-serif" size="2">Archive 
                    — если данный атрибут установлен, значит файл готов к архивированию 
                    или к удалению, </font> 
                  <li><font face="Arial, Helvetica, sans-serif" size="2">Compressed 
                    — наличие его означает, что файл упакован, </font> 
                  <li><font face="Arial, Helvetica, sans-serif" size="2">Device 
                    — зарезервирован для будущих версий операционной системы, 
                    </font> 
                  <li><font face="Arial, Helvetica, sans-serif" size="2">Directory 
                    — указывает на то, что файл является каталогом, </font> 
                  <li><font face="Arial, Helvetica, sans-serif" size="2">Encrypted 
                    — если этот атрибут установлен, значит файл зашифрован, </font> 
                  <li><font face="Arial, Helvetica, sans-serif" size="2">Hidden 
                    — наличие его указывает на то, что файл скрыт от стандартных 
                    операций просмотра каталога, </font> 
                  <li><font face="Arial, Helvetica, sans-serif" size="2">Normal 
                    — указывает на то, что у файла не установлены другие атрибуты, 
                    </font> 
                  <li><font face="Arial, Helvetica, sans-serif" size="2">NotContentIndexed 
                    — файл не индексируется системой Windows Indexing System, 
                    </font> 
                  <li><font face="Arial, Helvetica, sans-serif" size="2">Offline 
                    — содержимое файла не доступно в режиме офлайн, </font> 
                  <li><font face="Arial, Helvetica, sans-serif" size="2">ReadOnly 
                    — содержимое файла не может быть изменено, </font> 
                  <li><font face="Arial, Helvetica, sans-serif" size="2">ReparsePoint 
                    — файл содержит блок данных, ассоциированных с файлом или 
                    каталогом, </font> 
                  <li><font face="Arial, Helvetica, sans-serif" size="2">SparsePoint 
                    — файл обычно содержит большой объем пустых данных, </font> 
                  <li><font face="Arial, Helvetica, sans-serif" size="2">System 
                    — файл является системным файлом — частью операционной системы 
                    или используется исключительно операционной системой, </font> 
                  <li><font face="Arial, Helvetica, sans-serif" size="2">Temporary 
                    — файл является временным файлом, созданным либо операционной 
                    системой, либо пользовательским приложением; </font></li>
                </ul>
              <li><font face="Arial, Helvetica, sans-serif" size="2">CreationTime 
                — используется для получения или изменения даты создания файла. 
                Это свойство имеет тип DateTime; </font> 
              <li><font face="Arial, Helvetica, sans-serif" size="2">Exists — 
                это булево свойство используется для подтверждения того, что файл 
                или каталог существует; </font> 
              <li><font face="Arial, Helvetica, sans-serif" size="2">Extension 
                — возвращает строку, содержащую расширение имени файла; </font> 
              <li><font face="Arial, Helvetica, sans-serif" size="2">FullName 
                — это свойство используется для нахождения полного имени каталога 
                или файла; </font> 
              <li><font face="Arial, Helvetica, sans-serif" size="2">LastAccessTime 
                и LastWriteTime — два этих свойства типа DateTime используются 
                для получения или изменения даты последнего доступа или последней 
                записи в файл или каталог соответственно; </font> 
              <li><font face="Arial, Helvetica, sans-serif" size="2">Name — это 
                свойство используется для нахождения имени файла или последнего 
                каталога в иерархии каталогов; </font> 
              <li><font face="Arial, Helvetica, sans-serif" size="2">Delete() 
                — этот метод используется для удаления файла или каталога. </font></li>
            </ul>
            <p align="justify"><font face="Arial, Helvetica, sans-serif" size="2">Вышеперечисленные 
              свойства и методы доступны в классах, базирующихся на классе FileSystemInfo, 
              — классах FileInfo и DirectoryInfo.</font></p>
            <hr noshade size="1" width="85%">
            <h3><font face="Arial, Helvetica, sans-serif" size="3"><img src="rombik.gif" width="31" height="27" align="absmiddle"><a name=02></a>Класс 
              FileInfo</font></h3>
            <p align="justify"><font face="Arial, Helvetica, sans-serif" size="2">Этот 
              класс, выполняющий роль «оболочки» вокруг маршрута к файлу, расширяет 
              класс FileSystemInfo, добавляя к нему свойства и методы для манипуляции 
              файлами. Класс FileInfo добавляет следующие свойства и методы:</font></p>
            <ul>
              <li><font face="Arial, Helvetica, sans-serif" size="2">Directory 
                — это свойство возвращает объект DirectoryInfo, содержащий информацию 
                о родительском каталоге; </font> 
              <li><font face="Arial, Helvetica, sans-serif" size="2">DirectoryName 
                — возвращает полный маршрут к файлу; </font> 
              <li><font face="Arial, Helvetica, sans-serif" size="2">Length — 
                возвращает размер текущего файла в виде значения типа Long; </font> 
              <li><font face="Arial, Helvetica, sans-serif" size="2">AppendText() 
                — этот метод создает класс StreamWriter, используемый для добавления 
                к файлу текстовой информации; </font> 
              <li><font face="Arial, Helvetica, sans-serif" size="2">CopyTo(String), 
                или CopyTo(String, Boolean) — мы используем эти методы для копирования 
                существующего файла в новый файл; </font> 
              <li><font face="Arial, Helvetica, sans-serif" size="2">Create() 
                — мы используем этот метод для создания файла — этот метод возвращает 
                объект FileStream; </font> 
              <li><font face="Arial, Helvetica, sans-serif" size="2">CreateText() 
                — этот метод создает объект типа StreamWriter, используемый для 
                записи в новый текстовый файл; </font> 
              <li><font face="Arial, Helvetica, sans-serif" size="2">MoveTo(String) 
                — этот метод используется для переименования файла или перемещения 
                файла в другой каталог; </font> 
              <li><font face="Arial, Helvetica, sans-serif" size="2">Open(FileMode), 
                или Open(FileMode, FileAccess), или Open(FileMode, FileAccess, 
                FileShare) — этот метод открывает файл и возвращает объект типа 
                FileStream; </font> 
              <li><font face="Arial, Helvetica, sans-serif" size="2">OpenRead() 
                — мы используем данный метод для создания объекта FileStream с 
                доступом к файлу только для чтения; </font> 
              <li><font face="Arial, Helvetica, sans-serif" size="2">OpenText() 
                — этот метод создает объект StreamReader с кодировкой UTF8, который 
                используется для чтения из существующего файла; </font> 
              <li><font face="Arial, Helvetica, sans-serif" size="2">OpenWrite() 
                — мы используем данный метод для создания объекта FileStream с 
                доступом к файлу как для чтения, так и для записи. </font></li>
            </ul>
            <p align="justify"><font face="Arial, Helvetica, sans-serif" size="2"><a href="http://www.compress.ru/Temp/3485/2.htm">Диаграмма</a> 
              показывает, как методы класса FileInfo соотносятся с потоковыми 
              классами.</font></p>
            <p align="center"><img src="file_2.gif" width="250" height="257"></p>
            <p align="justify"><font face="Arial, Helvetica, sans-serif" size="2">Следующий 
              пример демонстрирует, как использовать класс FileInfo для отображения 
              размеров и атрибутов файлов в каталоге:</font></p>
            <pre><font face="Arial, Helvetica, sans-serif" size="2">'----------------------------------------  
' Использование класса FileInfo  
'----------------------------------------  
&nbsp;  
Imports System  
Imports System.IO  
&nbsp;  
Module VBDemo  
&nbsp;  
&nbsp;Sub Main()  
&nbsp;   
&nbsp; Dim Path As String = GetPersonalFolder() &amp; "\MyText"  
&nbsp; Dim DirInfo As New DirectoryInfo(Path)  
&nbsp; Dim Files As FileInfo() = DirInfo.GetFiles("*.TXT")  
&nbsp; Dim I As Integer  
&nbsp; Console.WriteLine(Path &amp; ControlChars.CrLf)  
&nbsp; For I = Files.GetLowerBound(0) To Files.GetUpperBound(0)  
&nbsp;&nbsp; Console.Write((Files(I).Name.PadRight(15)) &amp; _  
&nbsp;&nbsp;&nbsp; (Files(I).Length).ToString.PadRight(15))  
&nbsp;&nbsp; Console.Write(ControlChars.Tab)  
&nbsp;&nbsp; Console.WriteLine(ShowAttribs(Files(I)))  
&nbsp; Next  
&nbsp;  
&nbsp;End Sub  
&nbsp;  
&nbsp;Function GetPersonalFolder() As String  
&nbsp;  
&nbsp; Dim E As Environment  
&nbsp; Return E.GetFolderPath(Environment.SpecialFolder.Personal)  
&nbsp;  
&nbsp;End Function  
&nbsp;  
&nbsp;Function ShowAttribs(ByVal F As FileInfo) As String  
&nbsp;  
&nbsp; Dim S As String  
&nbsp; With F  
&nbsp;&nbsp; If .Attributes And FileAttributes.Archive Then  
&nbsp; &nbsp;&nbsp;&nbsp;S = "A"  
&nbsp;&nbsp; Else  
&nbsp;&nbsp;&nbsp;&nbsp; S = "-"  
&nbsp;&nbsp; End If  
&nbsp;&nbsp; If .Attributes And FileAttributes.Hidden Then  
&nbsp;&nbsp;&nbsp;&nbsp; S += "H"  
&nbsp;&nbsp; Else  
&nbsp;&nbsp;&nbsp;&nbsp; S += "-"  
&nbsp;&nbsp; End If  
&nbsp;&nbsp; If .Attributes And FileAttributes.Normal Then  
&nbsp;&nbsp;&nbsp;&nbsp; S += "N"  
&nbsp;&nbsp; Else  
&nbsp;&nbsp;&nbsp;&nbsp; S += "-"  
&nbsp;&nbsp; End If  
&nbsp;&nbsp; If .Attributes And FileAttributes.ReadOnly Then  
&nbsp;&nbsp;&nbsp;&nbsp; S += "R"  
&nbsp;&nbsp; Else  
&nbsp;&nbsp;&nbsp;&nbsp; S += "-"  
&nbsp;&nbsp; End If  
&nbsp; End With  
&nbsp; Return S  
&nbsp;  
&nbsp;End Function  
&nbsp;  
End Module  </font></pre>
            <p align="center"><font face="Arial, Helvetica, sans-serif" size="2"><img src="file_3.gif" width="475" height="88"></font></p>
            <p align="center"><font face="Arial, Helvetica, sans-serif" size="2">Приведем 
              еще один пример — ниже показано, как использовать метод CreateText 
              для создания объекта StreamWriter и записи в новый текстовый файл:</font></p>
            <pre><font face="Arial, Helvetica, sans-serif" size="2">'----------------------------------------  
' Использование класса FileInfo  
'----------------------------------------  
&nbsp;  
Imports System  
Imports System.IO  
&nbsp;  
Module VBDemo  
&nbsp;  
&nbsp;Sub Main()  
&nbsp; Dim FileName As String = "c:\temp\mytext01.txt"  
&nbsp; Dim Writer As StreamWriter  
&nbsp; Dim MyFile As New FileInfo(FileName)  
&nbsp;  
&nbsp; Writer = MyFile.CreateText()  
&nbsp;  
&nbsp; Writer.WriteLine("Created by " &amp; MyFile.GetType.ToString)  
&nbsp; Writer.WriteLine("Written by " &amp; Writer.ToString)  
&nbsp;  
&nbsp; Writer.Close()  
&nbsp;  
End Sub  </font></pre>
            <p align="justify"><font face="Arial, Helvetica, sans-serif" size="2">В 
              результате мы получим следующий текстовый файл.</font></p>
            <p align="center"><img src="file_4.gif" width="374" height="230"></p>
            <p align="justify"><font face="Arial, Helvetica, sans-serif" size="2">Примеры 
              использования других методов класса FileInfo приведены в разделе, 
              посвященном классу File.</font></p>
            <hr noshade size="1" width="85%">
            <h3><font face="Arial, Helvetica, sans-serif" size="3"><img src="rombik.gif" width="31" height="27" align="absmiddle"><a name=03></a>Класс 
              DirectoryInfo</font></h3>
            <p align="justify"><font face="Arial, Helvetica, sans-serif" size="2">Этот 
              класс позволяет создавать и перемещать каталоги, а также получать 
              содержимое каталогов и подкаталогов. Класс DirectoryInfo содержит 
              следующие свойства:</font></p>
            <ul>
              <li><font face="Arial, Helvetica, sans-serif" size="2">Parent — 
                возвращает родительский каталог для данного подкаталога. Это свойство 
                имеет тип DirectoryInfo; </font> 
              <li><font face="Arial, Helvetica, sans-serif" size="2">Root — возвращает 
                корневой каталог для данного маршрута как тип DirectoryInfo. </font></li>
            </ul>
            <p align="justify"><font face="Arial, Helvetica, sans-serif" size="2">Следующий 
              пример показывает, как использовать свойства Parent и Root для восстановления 
              корневого каталога для данного каталога:</font></p>
            <pre><font face="Arial, Helvetica, sans-serif" size="2">'----------------------------------------  
' Использование класса DirectoryInfo  
'----------------------------------------  
&nbsp;  
Imports System  
Imports System.IO  
&nbsp;  
Module VBDemo  
&nbsp;  
&nbsp;Sub Main()  
&nbsp;  
&nbsp; Dim Path As String = GetPersonalFolder() &amp; "\MyText"  
&nbsp; Dim DirInfo As New DirectoryInfo(Path)  
&nbsp; Dim Parent As String  
&nbsp;  
&nbsp; Console.WriteLine("Initial Directory : " &amp; DirInfo.FullName)  
&nbsp; Parent = DirInfo.<b>Parent</b>.FullName  
&nbsp; While Parent &lt;&gt; DirInfo.<b>Root</b>.FullName  
&nbsp;&nbsp;&nbsp; Console.WriteLine("Parent Directory&nbsp; : " &amp; _  
&nbsp;&nbsp;&nbsp;&nbsp; DirInfo.Parent.FullName)  
&nbsp;&nbsp;&nbsp; Parent = DirInfo.<b>Parent</b>.FullName  
&nbsp;&nbsp;&nbsp; DirInfo = New DirectoryInfo(Parent)  
&nbsp;&nbsp; End While  
&nbsp;  
&nbsp;End Sub  
&nbsp;  
&nbsp;Function GetPersonalFolder() As String  
&nbsp;  
&nbsp; Dim E As Environment  
&nbsp; Return E.GetFolderPath(Environment.SpecialFolder.Personal)  
&nbsp;  
&nbsp;End Function  
&nbsp;  
End Module  </font></pre>
            <p align="justify"><font face="Arial, Helvetica, sans-serif" size="2">Ниже 
              приведены методы, доступные в классе DirectoryInfo:</font></p>
            <ul>
              <li><font face="Arial, Helvetica, sans-serif" size="2">Create() 
                — этот метод используется для создания каталога; </font> 
              <li><font face="Arial, Helvetica, sans-serif" size="2">CreateSubDirectory(String) 
                — метод используется для создания подкаталога. Он возвращает объект 
                DirectoryInfo для вновь созданного каталога. Следующий пример 
                демонстрирует, как использовать методы Create и CreateSubDirectory: 
                </font></li>
            </ul>
            <pre><font face="Arial, Helvetica, sans-serif" size="2">'----------------------------------------  
' Использование класса DirectoryInfo  
'----------------------------------------  
&nbsp;  
Imports System  
Imports System.IO  
&nbsp;  
Module VBDemo  
&nbsp;  
&nbsp;Sub Main()  
&nbsp;  
&nbsp; Dim Path As String = "c:\temp\demos"  
&nbsp; Dim DirInfo As New DirectoryInfo(Path)  
&nbsp; DirInfo.Create()  
&nbsp; DirInfo.CreateSubdirectory("ch04")  
&nbsp;  
&nbsp;End Sub  
&nbsp;  
End Module  </font></pre>
            <div align="center"><img src="file_5.gif" width="266" height="246"></div>
            <ul>
              <li><font face="Arial, Helvetica, sans-serif" size="2">GetDirectories() 
                — этот метод возвращает подкаталоги текущего каталога как массив 
                элементов DirectoryInfo. Ниже показано использование метода GetDirectories 
                для получения списка каталогов на диске C:\: </font></li>
            </ul>
            <pre><font face="Arial, Helvetica, sans-serif" size="2">'----------------------------------------  
' Использование класса DirectoryInfo  
'----------------------------------------  
&nbsp;  
Imports System  
Imports System.IO  
&nbsp;  
Module VBDemo  
&nbsp;  
&nbsp;Sub Main()  
&nbsp;  
&nbsp; Dim Path As String = "c:\"  
&nbsp; Dim DirInfo As New DirectoryInfo(Path)  
&nbsp; Dim Dirs() As DirectoryInfo  
&nbsp; Dim I As Integer  
&nbsp;  
&nbsp; Console.WriteLine("Initial Directory : " &amp; DirInfo.FullName)  
&nbsp; Dirs = DirInfo.GetDirectories  
&nbsp; For I = 0 To Dirs.GetUpperBound(0)  
&nbsp;&nbsp; Console.WriteLine(Dirs(I).FullName)  
&nbsp; Next  
&nbsp;  
&nbsp;End Sub  
&nbsp;  
End Module  </font></pre>
            <ul>
              <li><font face="Arial, Helvetica, sans-serif" size="2">GetFiles() 
                — данный метод возвращает массив элементов FileInfo для файлов 
                в текущем каталоге. Мы уже видели пример использования этого метода 
                в предыдущем разделе, когда обсуждали класс FileInfo; </font> 
              <li><font face="Arial, Helvetica, sans-serif" size="2">GetFileSystemInfos() 
                — метод возвращает массив элементов FileSystemInfo для файлов 
                в текущем каталоге; </font> 
              <li><font face="Arial, Helvetica, sans-serif" size="2">MoveTo(String) 
                — метод перемещает каталог и его содержимое в новое место. </font></li>
            </ul>
            <hr noshade size="1" width="85%">
            <h2><font face="Arial, Helvetica, sans-serif" size="3"><img src="rombik.gif" width="31" height="27" align="absmiddle"><a name=04></a>Перечисление 
              Environment.SpecialFolder</font></h2>
            <p align="justify"><font face="Arial, Helvetica, sans-serif" size="2">Данное 
              перечисление используется для получения маршрутов к специальным 
              системным каталогам типа Program Files, Programs, System, Startup 
              и т.п. Ниже показаны члены перечисления SpecialFolder:</font></p>
            <ul>
              <li><font face="Arial, Helvetica, sans-serif" size="2">ApplicationData 
                — возвращает маршрут к каталогу, используемому как общее хранилище 
                данных для приложений; </font> 
              <li><font face="Arial, Helvetica, sans-serif" size="2">CommonApplicationData 
                — возвращает маршрут к каталогу, используемому как общее хранилище 
                данных для приложений, доступное всем пользователям; </font> 
              <li><font face="Arial, Helvetica, sans-serif" size="2">CommonProgramFiles 
                — возвращает маршрут к каталогу, используемому как хранилище общих 
                компонентов приложений; </font> 
              <li><font face="Arial, Helvetica, sans-serif" size="2">Cookies — 
                возвращает маршрут к каталогу, используемому для хранения cookies; 
                </font> 
              <li><font face="Arial, Helvetica, sans-serif" size="2">DesktopDirectory 
                — возвращает маршрут к каталогу, используемому для хранения файлов 
                и объектов на desktop; </font> 
              <li><font face="Arial, Helvetica, sans-serif" size="2">Favorities 
                — возвращает маршрут к каталогу, используемому для хранения пользовательских 
                закладок; </font> 
              <li><font face="Arial, Helvetica, sans-serif" size="2">History — 
                возвращает маршрут к каталогу, используемому для хранения ссылок 
                на ранее посещавшиеся узлы Internet; </font> 
              <li><font face="Arial, Helvetica, sans-serif" size="2">InternetCache 
                — возвращает маршрут к каталогу, используемому для хранения временных 
                Internet-файлов; </font> 
              <li><font face="Arial, Helvetica, sans-serif" size="2">LocalApplicationData 
                — возвращает маршрут к каталогу, используемому для хранения данных 
                приложений; </font> 
              <li><font face="Arial, Helvetica, sans-serif" size="2">Personal 
                — возвращает маршрут к каталогу, используемому для хранения пользовательских 
                документов; </font> 
              <li><font face="Arial, Helvetica, sans-serif" size="2">ProgramFiles 
                — возвращает маршрут к каталогу, используемому для хранения программ; 
                </font> 
              <li><font face="Arial, Helvetica, sans-serif" size="2">Programs 
                — возвращает маршрут к каталогу, используемому для хранения программных 
                групп; </font> 
              <li><font face="Arial, Helvetica, sans-serif" size="2">Recent — 
                возвращает маршрут к каталогу, используемому для хранения документов, 
                с которыми пользователь работал в последнее время; </font> 
              <li><font face="Arial, Helvetica, sans-serif" size="2">SendTo — 
                возвращает маршрут к каталогу, используемому для хранения элементов 
                меню SendTo; </font> 
              <li><font face="Arial, Helvetica, sans-serif" size="2">StartMenu 
                — возвращает маршрут к каталогу, используемому для хранения элементов 
                меню Start; </font> 
              <li><font face="Arial, Helvetica, sans-serif" size="2">Startup — 
                возвращает маршрут к каталогу, используемому для хранения элементов 
                группы Startup; </font> 
              <li><font face="Arial, Helvetica, sans-serif" size="2">System — 
                возвращает маршрут к каталогу System; </font> 
              <li><font face="Arial, Helvetica, sans-serif" size="2">Templates 
                — возвращает маршрут к каталогу, используемому для хранения шаблонов 
                документов. </font></li>
            </ul>
            <p align="justify"><font face="Arial, Helvetica, sans-serif" size="2">Ниже 
              показаны типичные имена для специальных системных каталогов в системе 
              Windows 2000:</font></p>
            <pre><font face="Arial, Helvetica, sans-serif" size="2">'------------------------------------------------------  
' Использование перечисления Environment.SpecialFolder   
'------------------------------------------------------  
&nbsp;  
Imports System  
Imports System.IO  
&nbsp;  
Module VBDemo  
&nbsp;  
&nbsp;Sub Main()  
&nbsp; Dim E As Environment  
&nbsp; Dim Names As String()  
&nbsp; Dim Values() As Integer  
&nbsp; Dim I As Integer  
&nbsp;  
&nbsp; Console.WriteLine("SpecialFolder Enumeration")  
&nbsp; Names&nbsp; = SpecialFolder.System.GetNames(SpecialFolder.System.GetType)  
&nbsp; Values = SpecialFolder.GetValues(SpecialFolder.System.GetType)  
&nbsp;  
&nbsp; For I = 0 To Names.GetUpperBound(0)  
&nbsp;&nbsp;&nbsp; Console.WriteLine(ControlChars.Tab &amp; Names(I) &amp; "=" &amp; _  
&nbsp;&nbsp;&nbsp;&nbsp; E.GetFolderPath(Values(I)))  
&nbsp; Next  
&nbsp;  
End Sub  </font></pre>
            <p align="justify"> </p>
            <div align="center"><img src="file_6.gif" width="665" height="379"> 
            </div>
            <hr noshade size="1" width="85%">
            <h3><font face="Arial, Helvetica, sans-serif" size="3"><img src="rombik.gif" width="31" height="27" align="absmiddle"><a name=05></a>Класс 
              File</font></h3>
            <p align="justify"><font face="Arial, Helvetica, sans-serif" size="2">Этот 
              класс обеспечивает набор статических методов, которые могут быть 
              использованы для создания, копирования, удаления, перемещения и 
              открытия файлов. Некоторые из методов класса File создают объекты 
              StreamWriter и FileStream.</font></p>
            <p align="justify"><font face="Arial, Helvetica, sans-serif" size="2">Метод 
              Create(String), или Create (String, Integer), используется для создания 
              файла в указанном каталоге с указанным размером буфера. Этот метод 
              возвращает объект FileStream. Метод CreateText(String) создает объект 
              StreamWriter, который записывает в новый текстовый файл с указанным 
              полным именем. Мы используем метод AppendText(String) для создания 
              объекта StreamWriter, используемого для добавления текста к существующему 
              файлу или для создания нового файла. Для проверки того, существует 
              файл или нет, используется метод Exists(String).</font></p>
            <p align="justify"><font face="Arial, Helvetica, sans-serif" size="2">Метод 
              Open(String, FileMode), или Open(String, FileMode, FileAccess), 
              или Open(String, FileMode, FileAccess, FileShare), открывает объект 
              FileStream для указанного файла, метод OpenRead(String) создает 
              объект FileStream для чтения из существующего файла, а метод OpenWrite(String) 
              создает объект FileStream с доступом к файлу через операции чтения 
              и записи. Метод OpenText(String) создает объект StreamReader, используемый 
              для чтения из файла.</font></p>
            <p align="justify"><font face="Arial, Helvetica, sans-serif" size="2">На 
              следующей диаграмме показано, как методы класса File соотносятся 
              с потоковыми классами.</font></p>
            <p align="center"><img src="file_2.gif" width="250" height="257"></p>
            <p align="justify"><font face="Arial, Helvetica, sans-serif" size="2">Метод 
              Copy(String, String), или Copy(String, String, Boolean) используется 
              для копирования существующего файла в новый файл либо с перезаписью 
              содержимого файла, либо без таковой. Для удаления файла мы используем 
              метод Delete(String), а для перемещения указанного файла в новое 
              место и для опционального изменения имени файла — метод Move(String, 
              String).</font></p>
            <p align="justify"><font face="Arial, Helvetica, sans-serif" size="2">Класс 
              File имеет четыре пары методов Get/Set, используемых для управления 
              атрибутами, временем создания, временем доступа и временем последней 
              записи в файл. Эти методы перечислены в следующей таблице.</font></p>
            <table border="1" width="100%" bordercolor="#CCCCCC" cellspacing="0">
              <tr> 
                <td>GetAttributes(String): FileAttributes</td>
                <td>SetAttributes(String, FileAttributes): FileAttributes</td>
                <td>Эти методы используются для управления атрибутами (FileAttributes) 
                  указанного файла</td>
              </tr>
              <tr> 
                <td>GetCreationTime</td>
                <td>SetCreationTime</td>
                <td>Эти методы используются для получения или изменения даты и 
                  времени создания указанного файла</td>
              </tr>
              <tr> 
                <td>GetLastAccessTime</td>
                <td>SetLastAccessTime</td>
                <td>Эти методы используются для получения или изменения даты и 
                  времени последнего доступа к указанному файлу</td>
              </tr>
              <tr> 
                <td>GetLastWriteTime</td>
                <td>SetLastWriteTime</td>
                <td>Эти методы используются для получения или изменения даты и 
                  времени последней записи в указанный файл</td>
              </tr>
            </table>
            <p align="justify"><font face="Arial, Helvetica, sans-serif" size="2">Ниже 
              демонстрируется использование метода Open для открытия потока FileStream 
              для указанного файла:</font></p>
            <pre><font face="Arial, Helvetica, sans-serif" size="2">'----------------------------  
' Использование класса File   
'----------------------------  
&nbsp;  
Imports System  
Imports System.IO  
&nbsp;  
Module VBDemo  
&nbsp;  
&nbsp;Sub Main()  
&nbsp; Dim MyFile As String = "c:\temp\mytext\mytext01.txt"  
&nbsp; Dim FS As FileStream  
&nbsp; Dim Reader As StreamReader  
&nbsp;  
&nbsp; FS = File.Open(MyFile, FileMode.Open)  
&nbsp; Reader = New StreamReader(FS)  
&nbsp;  
&nbsp; While Reader.Peek() &gt; -1  
&nbsp;&nbsp;&nbsp; Console.WriteLine(Reader.ReadLine())  
&nbsp; End While  
&nbsp; Reader.Close()  
&nbsp; FS.Close()  
&nbsp;  
&nbsp;End Sub  
&nbsp;  
End Module  </font></pre>
            <p align="justify"><font face="Arial, Helvetica, sans-serif" size="2">Обратите 
              внимание на то, что при вызове метода Open объекта File мы указали 
              способ доступа к файлу. Возможные модификаторы доступа к файлу доступны 
              через перечисление FileMode и показаны ниже:</font></p>
            <ul>
              <li><font face="Arial, Helvetica, sans-serif" size="2">Append — 
                указывает на то, что файл открывается в режиме добавления — в 
                этом режиме чтение из файла невозможно; </font> 
              <li><font face="Arial, Helvetica, sans-serif" size="2">Create — 
                указывает на то, что новый файл должен быть создан операционной 
                системой. Если указанный файл существует, он будет перезаписан; 
                </font> 
              <li><font face="Arial, Helvetica, sans-serif" size="2">CreateNew 
                — указывает на то, что новый файл должен быть создан операционной 
                системой; </font> 
              <li><font face="Arial, Helvetica, sans-serif" size="2">Open — указывает 
                на то, что указанный файл должен быть открыт; </font> 
              <li><font face="Arial, Helvetica, sans-serif" size="2">OpenOrCreate 
                — указывает на то, что файл должен быть открыт. Если файл не существует, 
                операционная система создает новый файл; </font> 
              <li><font face="Arial, Helvetica, sans-serif" size="2">Truncate 
                — указывает на то, что существующий файл должен быть открыт и 
                его размер должен быть уменьшен до 0 байт. </font></li>
            </ul>
            <p align="justify"><font face="Arial, Helvetica, sans-serif" size="2">Следующий 
              пример показывает использование метода OpenFile класса StreamReader:</font></p>
            <pre><font face="Arial, Helvetica, sans-serif" size="2">'----------------------------  
' Использование класса File   
'----------------------------  
&nbsp;  
Imports System  
Imports System.IO  
&nbsp;  
Module VBDemo  
&nbsp;  
&nbsp;Sub Main()  
&nbsp;  
&nbsp; Dim MyFile As String = "c:\temp\mytext\mytext01.txt"  
&nbsp; Dim Reader As StreamReader  
&nbsp;  
&nbsp; Reader = File.OpenText(MyFile)  
&nbsp; While Reader.Peek() &gt; -1  
&nbsp;&nbsp; Console.WriteLine(Reader.ReadLine())  
&nbsp; End While  
&nbsp; Reader.Close()  
&nbsp;  
&nbsp;End Sub  
&nbsp;  
End Module   
Ниже демонстрируется использование методов   GetXXX:
'----------------------------  
' Использование класса File   
'----------------------------  
&nbsp;  
Imports System  
Imports System.IO  
&nbsp;  
Module VBDemo  
&nbsp;  
&nbsp;Sub Main()  
&nbsp; Dim MyFile As String = "c:\temp\mytext\mytext01.txt"  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   
&nbsp; Console.WriteLine()  
&nbsp; Console.WriteLine(MyFile)  
&nbsp; Console.WriteLine("Attributes&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; : " &amp; _  
&nbsp;&nbsp; ShowAttribs(File.GetAttributes(MyFile)))  
&nbsp; Console.WriteLine("Creation time&nbsp;&nbsp;&nbsp; : " &amp; _  
&nbsp;&nbsp; File.GetCreationTime(MyFile))  
&nbsp; Console.WriteLine("Last access time : " &amp; _  
&nbsp;&nbsp; File.GetLastAccessTime(MyFile))  
&nbsp; Console.WriteLine("Last write time&nbsp; : " &amp; _  
&nbsp;&nbsp; File.GetLastWriteTime(MyFile))  
&nbsp;  
&nbsp;End Sub  
&nbsp;  
&nbsp;Function ShowAttribs(ByVal Attributes As FileAttributes) As String  
&nbsp;  
&nbsp; Dim S As String  
&nbsp;  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; If Attributes And FileAttributes.Archive Then  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; S = "A"  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Else  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; S = "-"  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End If  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; If Attributes And FileAttributes.Hidden Then  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; S += "H"  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Else  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; S += "-"  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End If  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; If Attributes And FileAttributes.Normal Then  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; S += "N"  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Else  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; S += "-"  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End If  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; If Attributes And FileAttributes.ReadOnly Then  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; S += "R"  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Else  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; S += "-"  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End If  
&nbsp;  
&nbsp; Return S  
&nbsp;  
&nbsp; End Function  </font></pre>
            <p align="center"><font face="Arial, Helvetica, sans-serif" size="2"><img src="file_8.gif" width="297" height="64"></font></p>
            <p align="justify"><font face="Arial, Helvetica, sans-serif" size="2">И 
              еще один пример — в нем показано, как использовать метод OpenWrite 
              для открытия потока FileStream для указанного файла и записи в него:</font></p>
            <pre><font face="Arial, Helvetica, sans-serif" size="2">'----------------------------  
' Использование класса File   
'----------------------------  
&nbsp;  
Imports System  
Imports System.IO  
&nbsp;  
Module VBDemo  
&nbsp;  
&nbsp;Sub Main()  
&nbsp; Dim MyFile As String = "c:\temp\mytext\mytext01.txt"  
&nbsp; Dim FS As FileStream  
&nbsp; Dim Writer As StreamWriter  
&nbsp;  
&nbsp; FS = File.OpenWrite(MyFile)  
&nbsp; Writer = New StreamWriter(FS)  
&nbsp; FS.Seek(0, SeekOrigin.End)  
&nbsp; Writer.WriteLine("One more line")  
&nbsp; Writer.Flush()  
&nbsp; Writer.Close()  
&nbsp; FS.Close()  
&nbsp;  
&nbsp;End Sub  
&nbsp;  
End Module  </font></pre>
            <hr noshade size="1" width="85%">
            <h3><font face="Arial, Helvetica, sans-serif" size="3"><img src="rombik.gif" width="31" height="27" align="absmiddle"><a name=06></a>Класс 
              Path</font></h3>
            <p align="justify"><font face="Arial, Helvetica, sans-serif" size="2">Класс 
              Path предоставляет набор статических методов, используемых для обработки 
              имен файлов и каталогов. Методы, реализованные в этом классе, следующие:</font></p>
            <ul>
              <li><font face="Arial, Helvetica, sans-serif" size="2">ChangeExtension(String, 
                String) — этот метод используется для того, чтобы изменить расширение 
                имени файла, и возвращает результат в виде переменной типа String; 
                </font> 
              <li><font face="Arial, Helvetica, sans-serif" size="2">Combine(String, 
                String) — метод объединяет два имени файлов и возвращает результат 
                в виде переменной типа String; </font> 
              <li><font face="Arial, Helvetica, sans-serif" size="2">GetDirectoryName(String) 
                — возвращает имя каталога для указанного файла; </font> 
              <li><font face="Arial, Helvetica, sans-serif" size="2">GetExtension(String) 
                — возвращает расширение имени файла; </font> 
              <li><font face="Arial, Helvetica, sans-serif" size="2">GetFileName(String) 
                — возвращает имя файла; </font> 
              <li><font face="Arial, Helvetica, sans-serif" size="2">GetFileNameWithoutExtension(String) 
                — возвращает имя файла без расширения; </font> 
              <li><font face="Arial, Helvetica, sans-serif" size="2">GetFullPath(String) 
                — возвращает полное имя файла; </font> 
              <li><font face="Arial, Helvetica, sans-serif" size="2">GetPathRoot(String) 
                — возвращает корневой каталог для заданного файла; </font> 
              <li><font face="Arial, Helvetica, sans-serif" size="2">GetTempFileName() 
                — возвращает уникальное имя временного файла и создает файл нулевой 
                длины с данным именем; </font> 
              <li><font face="Arial, Helvetica, sans-serif" size="2">GetTempPath() 
                — возвращает маршрут к временному системному каталогу; </font> 
              <li><font face="Arial, Helvetica, sans-serif" size="2">HasExtension(String) 
                — проверяет, содержит ли имя файла расширение; </font> 
              <li><font face="Arial, Helvetica, sans-serif" size="2">IsPathRooted(String) 
                — проверяет, содержит ли полное имя файла корневой каталог. </font></li>
            </ul>
            <p align="justify"><font face="Arial, Helvetica, sans-serif" size="2">В 
              следующем примере демонстрируется использование ряда методов класса 
              Path:</font></p>
            <pre><font face="Arial, Helvetica, sans-serif" size="2">'----------------------------  
' Использование класса Path  
'----------------------------  
&nbsp;  
Imports System  
Imports System.IO  
&nbsp;  
Module VBDemo  
&nbsp;  
&nbsp;Sub Main()  
&nbsp; Dim FullPath As String&nbsp;&nbsp;&nbsp; = "c:\book\ch04\ch04.doc"  
&nbsp; Dim FullPathExt As String = "c:\book\ch04.old\ch04.doc"  
&nbsp; Dim Partial1 As String&nbsp;&nbsp;&nbsp; = "c:\book"  
&nbsp; Dim Partial2 As String&nbsp;&nbsp;&nbsp; = "ch04"  
&nbsp;  
&nbsp; Console.WriteLine("ChangeExtension&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; : " &amp; _  
&nbsp;&nbsp; Path.ChangeExtension(FullPath, ".bak"))  
&nbsp; Console.WriteLine("Combine&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; : " &amp; _  
&nbsp;&nbsp; Path.Combine(Partial1, Partial2))  
&nbsp; Console.WriteLine("GetDirectoryName&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; : " &amp; _  
&nbsp;&nbsp; Path.GetDirectoryName(FullPath))  
&nbsp; Console.WriteLine("GetExtension&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; : " &amp; _  
&nbsp;&nbsp; Path.GetExtension(FullPathExt))  
&nbsp; Console.WriteLine("GetFileName&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; : " &amp; _  
&nbsp;&nbsp; Path.GetFileName(FullPath))  
&nbsp; Console.WriteLine("GetFileNameWithoutExtension : " &amp; _  
&nbsp;&nbsp; Path.GetFileNameWithoutExtension(FullPath))  
&nbsp; Console.WriteLine("GetFullPath&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; : " &amp; _  
&nbsp;&nbsp; Path.GetFullPath(FullPath))  
&nbsp; Console.WriteLine("GetPathRoot&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; : " &amp; _  
&nbsp;&nbsp; Path.GetPathRoot(FullPath))  
&nbsp; Console.WriteLine("GetTempFileName&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; : " &amp; _  
&nbsp;&nbsp; Path.GetTempFileName)  
&nbsp; Console.WriteLine("GetTempPath&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; : " &amp; _  
&nbsp;&nbsp; Path.GetTempPath)  
&nbsp; Console.WriteLine("HasExtension&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; : " &amp; _  
&nbsp;&nbsp; Path.HasExtension(FullPathExt))  
&nbsp; Console.WriteLine("IsPathRooted&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; : " &amp; _  
&nbsp;&nbsp; Path.IsPathRooted(Partial2))  
&nbsp;  
&nbsp;End Sub  
&nbsp;  
End Module  </font></pre>
            <p align="center"><font face="Arial, Helvetica, sans-serif" size="2"><img src="file_9.gif" width="607" height="155"></font></p>
            <p align="justify"><font face="Arial, Helvetica, sans-serif" size="2">Пять 
              свойств класса Path содержат специфичные для конкретной платформы 
              символы, которые перечислены ниже:</font></p>
            <ul>
              <li><font face="Arial, Helvetica, sans-serif" size="2">AltDirectorySeparatorChar, 
                </font> 
              <li><font face="Arial, Helvetica, sans-serif" size="2">DirectorySeparatorChar, 
                </font> 
              <li><font face="Arial, Helvetica, sans-serif" size="2">InvalidPathChars, 
                </font> 
              <li><font face="Arial, Helvetica, sans-serif" size="2">PathSeparator, 
                </font> 
              <li><font face="Arial, Helvetica, sans-serif" size="2">VolumeSeparatorChar. 
                </font></li>
            </ul>
            <p align="justify"><font face="Arial, Helvetica, sans-serif" size="2">Следующий 
              пример показывает содержимое этих свойств для платформы Microsoft 
              Windows.</font></p>
            <pre><font face="Arial, Helvetica, sans-serif" size="2">'----------------------------  
' Использование класса Path  
'----------------------------  
&nbsp;  
Imports System  
Imports System.IO  
&nbsp;  
Module VBDemo  
&nbsp;  
&nbsp;Sub Main()  
&nbsp;  
&nbsp; Console.WriteLine("AltDirectorySeparatorChar : " _  
&nbsp;&nbsp; &amp; Path.AltDirectorySeparatorChar)  
&nbsp; Console.WriteLine("DirectorySeparatorChar&nbsp;&nbsp;&nbsp; : " _  
&nbsp;&nbsp; &amp; Path.DirectorySeparatorChar)  
&nbsp; Console.WriteLine("InvalidPathChars&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; : " _  
&nbsp;&nbsp; &amp; Path.InvalidPathChars)  
&nbsp; Console.WriteLine("PathSeparator&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; : " _  
&nbsp;&nbsp; &amp; Path.PathSeparator)  
&nbsp; Console.WriteLine("VolumeSeparatorChar&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; : " _  
&nbsp;&nbsp; &amp; Path.VolumeSeparatorChar)  
&nbsp;  
&nbsp;End Sub  
&nbsp;  
End Module  </font></pre>
            <div align="center"><img src="file_10.gif" width="261" height="76"> 
            </div>
            <hr noshade size="1" width="85%">
            <p align="justify"><font face="Arial, Helvetica, sans-serif" size="2">На 
              этом мы завершаем знакомство с Microsoft .NET Framework — дальнейшее 
              обсуждение этой темы выходит за рамки тематики нашего издания. Более 
              подробную информацию о Microsoft .NET можно получить по адресу: 
              <a class=extra 
href="http://hosting.gotdotnet.ru/developnet/" 
target=_blank>http://hosting.gotdotnet.ru/developnet/</a> </font></p>
            <!-- InstanceEndEditable --></td>
        </tr>
      </table>
      </td>
  </tr>
</table>
<table width="100%" height="30" border="0" cellpadding="6" cellspacing="0">
  <tr> 
    <td background="fon2.gif" bgcolor="#FFFFCC"> 
      <div align="left"><font color="#000066" size="2" face="Arial, Helvetica, sans-serif">&copy; 
        <a href="mailto:stasmit@mail.ru">Волшебник Станислав</a>, <a href="http://www.mista.ru"><br>
        www.mista.ru</a>, 1997-2003</font></div></td>
    <td background="fon2.gif" bgcolor="#FFFFCC"> 

      <table border="0" align="center" cellpadding="2" cellspacing="0">
        <tr valign="middle" align="center"> 
          <td width="95"> 
            <script language="javascript"><!--
Mu="u045.09.spylog.com";Md=document;Mnv=navigator;Mp=0;
Md.cookie="b=b";Mc=0;if(Md.cookie)Mc=1;Mrn=Math.random();
Mn=(Mnv.appName.substring(0,2)=="Mi")?0:1;Mt=(new Date()).getTimezoneOffset();
Mz="p="+Mp+"&rn="+Mrn+"&c="+Mc+"&t="+Mt;
if(self!=top){Mfr=1;}else{Mfr=0;}Msl="1.0";
//--></script><script language="javascript1.1"><!--
Mpl="";Msl="1.1";Mj = (Mnv.javaEnabled()?"Y":"N");Mz+='&j='+Mj;
//--></script><script language="javascript1.2"><!-- 
Msl="1.2";Ms=screen;Mpx=(Mn==0)?Ms.colorDepth:Ms.pixelDepth;
Mz+="&wh="+Ms.width+'x'+Ms.height+"&px="+Mpx;
//--></script><script language="javascript1.3"><!--
Msl="1.3";//--></script><script language="javascript"><!--
My="";My+="<a href='http://"+Mu+"/cnt?cid=4509&f=3&p="+Mp+"&rn="+Mrn+"' target='_blank'>";
My+="<img src='http://"+Mu+"/cnt?cid=4509&"+Mz+"&sl="+Msl+"&r="+escape(Md.referrer)+"&fr="+Mfr+"&pg="+escape(window.location.href);
My+="' border=0 width=88 height=31 alt='SpyLOG'>";
My+="</a>";Md.write(My);//--></script><noscript>
<a href="http://u045.09.spylog.com/cnt?cid=4509&f=3&p=0" target="_blank">
<img src="http://u045.09.spylog.com/cnt?cid=4509&p=0" alt='SpyLOG' border='0' width=88 height=31 >
</a></noscript></noscript>
            </td>
          <td width="95"> <a href="http://www.1c.klim.org/topsites/index.html" target="_blank"> 
            <img src="http://1c.klim.org/topsites/topsites.php?ID=143" width="88" height="31" border="0" alt="1C:TOP-100"></a></td>
          <td width="95"> <script language="javascript">
hotlog_js="1.0";
hotlog_r=""+Math.random()+"&s=23314&im=101&r="+escape(document.referrer)+"&pg="+
escape(window.location.href);
document.cookie="hotlog=1; path=/"; hotlog_r+="&c="+(document.cookie?"Y":"N");
</script>
            <script language="javascript1.1">
hotlog_js="1.1";hotlog_r+="&j="+(navigator.javaEnabled()?"Y":"N")</script> <script language="javascript1.2">
hotlog_js="1.2";
hotlog_r+="&wh="+screen.width+'x'+screen.height+"&px="+
(((navigator.appName.substring(0,3)=="Mic"))?
screen.colorDepth:screen.pixelDepth)</script> <script language="javascript1.3">hotlog_js="1.3"</script> 
            <script language="javascript">hotlog_r+="&js="+hotlog_js;
document.write("<a href='http://click.hotlog.ru/?23314' target='_top'><img "+
" src='http://hit2.hotlog.ru/cgi-bin/hotlog/count?"+
hotlog_r+"&' border=0 width=88 height=31 alt=HotLog></a>")</script> <noscript>
            <a href=http://click.hotlog.ru/?23314 target=_top><img
src="http://hit2.hotlog.ru/cgi-bin/hotlog/count?s=23314&im=101" border=0 
width="88" height="31" alt="HotLog"></a></noscript> </td>
        </tr>
      </table>
      
    </td>
    <td background="../fon2.gif"> 
      <div align="right"><a href="#begin"> Наверх&nbsp;<img src="../top.gif" alt="^" width="16" height="14" border="0"></a></div></td>
  </tr>
</table>
</body>
<!-- InstanceEnd --></html>
